<!DOCTYPE html>

<html>                                                                
<head>
<title>LinkGame 0.1</title>
<!-- <link rel="stylesheet" href="/media/style.css"> -->
<script type="text/javascript"
src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>         
<script type="text/javascript">

var usedLinks = 0;
var points = 0;

$(document).ready(function(){

var startConcept = '{{ concept1 }}';
var endConcept = '{{ concept2 }}';

{% for relation, relationInfo in relationsList.items %}
$("#relationsMenu").append("<option value='{{ relation }}'>" + '{{ relationInfo.0 }}' + "</option>");
{% endfor %}


  
$("#linkButton").click(function() {  
  // validate form here

  var concept1 = $("#concept1").text()
  var concept2 = $("input#concept2").val();
  var relation = $("select#relationsMenu").val();
  
  if (concept1 == "") {
  //Do something if concept1 is blank
  //Maybe $("label#name_error").show();
  }

  if (concept2 == "") {
  //Do something if concept2 is blank
  }

  if (concept2 == endConcept) {
  var str = "You found a connection! Thanks for your contribution.";
  $("#linkButton").attr('disabled','disabled');
  } else {
  var str = concept1 + " " + relation + " " + concept2 + "<br />"
  $("#concept1").text(concept2)
  }



  addLink(str);

  assignPoints(getPointValue());
  $("#pointsVal").text(points);

  return false;
});  

  function assignPoints(p) {
  points = points + p;
  }

  function getPointValue() {
  return 1;
  }

  function addLink(str) {
    $("#linkslist").append(str);
    usedLinks = usedLinks + 1;
    $("#linksVal").text(usedLinks);
  }

});
</script>

  <script type="text/javascript">
  
  
  function draw(){
  var canvas = document.getElementById("canvas");
  var padding = 10;
  
  if (canvas.getContext){  
  var ctx = canvas.getContext("2d");

  ctx.font = "1em sans-serif";
  ctx.fillText('{{ concept1 }}', 60, 60);
  // ctx.beginPath();  
  // ctx.arc(75,75,50,0,Math.PI*2,true); // Outer circle  
  // ctx.stroke();   


  var metrics = ctx.measureText('hello');
  draw_node(ctx, 0, 0, metrics.width + padding, metrics.height + padding);
  ctx.fillText('hello', 0+padding/2, 10);
  } else {  
  // canvas-unsupported code here  
  }  }


  function draw_node(context, x, y, width, height) {
  context.strokeRect(x, y, width, 20); 
  };
  </script>
</head>                                                                 

<body onload="draw()">                                                                  

<div id="visuals" class="visual">
  <canvas id="canvas" width="500" height="200">Visualizes your path in the game.</canvas>
</div>


<div class="text">
  Try to find a connection between <span class="concept"> {{ concept1 }} </span> and <span class="concept">
  {{ concept2 }} </span>.
</div>

<div id="linkslist">

</div>

<div class="form">
  <form name="linkForm" id="linkForm" action="" method="" >
  <span class="concept" name="concept1" id="concept1">{{ concept1 }}</span>
  <select name="relation" id="relationsMenu" required="true">
  </select>
  <input type="text" name="concept2" id="concept2" required="true" />
  <button name="submitButton" id="linkButton" type="submit">Submit</button>
  </form>
</div>

<button action="" method="" name="getConceptsButton"
id="getConceptsButton" type="submit">Get New Concepts</button>
<br />
<span class="text" name="numLinks" id="numLinks">You used <span
id="linksVal">0</span> links</span> <br />
<span class="text" name="points" id="points">You have <span
id="pointsVal">0</span> points. </span>



  
</body>                                                                 
</html>